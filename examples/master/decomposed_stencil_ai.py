import tensorflow as tf
from tensorflow import keras
import numpy as np
import matplotlib.pyplot as plt
import os
from time import perf_counter
from halos_exchange import HaloExchange
import sys
np.set_printoptions(threshold=sys.maxsize)
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'  # avoid tf dnn flag issue

nx, ny = 100, 100
problem_mesh = np.array([[4, 2, 1, 3, 2, 3, 2, 2, 3, 1, 1, 3, 1, 1, 2, 2, 3, 4, 4, 3, 2, 3,
                          4, 2, 3, 4, 4, 2, 4, 1, 4, 4, 4, 1, 2, 2, 4, 4, 4, 1, 4, 2, 4, 1,
                          3, 2, 1, 1, 2, 3, 3, 2, 2, 1, 2, 1, 2, 4, 3, 1, 3, 1, 3, 2, 3, 2,
                          2, 2, 2, 4, 4, 3, 4, 3, 1, 1, 2, 1, 3, 1, 3, 3, 3, 2, 3, 3, 4, 4,
                          3, 4, 1, 1, 4, 2, 1, 4, 3, 4, 4, 3],
                         [3, 3, 4, 2, 3, 2, 4, 3, 4, 4, 4, 2, 2, 4, 1, 1, 2, 4, 1, 4, 3, 1,
                          1, 1, 2, 3, 2, 4, 1, 3, 3, 1, 3, 2, 2, 1, 1, 1, 4, 2, 4, 4, 4, 2,
                          4, 2, 1, 1, 2, 1, 2, 1, 2, 3, 4, 1, 4, 1, 2, 3, 4, 4, 4, 3, 2, 3,
                          3, 2, 3, 3, 2, 2, 2, 3, 2, 4, 1, 3, 2, 1, 4, 3, 2, 2, 3, 2, 2, 4,
                          2, 3, 3, 4, 4, 3, 2, 3, 4, 4, 2, 3],
                         [4, 4, 4, 3, 3, 3, 4, 2, 4, 1, 4, 2, 4, 2, 2, 1, 2, 2, 2, 4, 1, 1,
                          2, 2, 1, 4, 2, 1, 3, 2, 3, 2, 2, 2, 4, 2, 2, 1, 2, 1, 4, 4, 3, 3,
                          1, 2, 2, 1, 1, 2, 2, 4, 3, 1, 3, 4, 3, 2, 4, 4, 4, 1, 1, 4, 4, 1,
                          3, 4, 3, 2, 4, 2, 2, 1, 2, 1, 1, 3, 1, 4, 1, 4, 3, 4, 3, 2, 4, 2,
                          1, 4, 2, 4, 1, 1, 3, 3, 1, 2, 2, 4],
                         [2, 2, 3, 1, 2, 4, 1, 2, 1, 2, 4, 3, 3, 2, 2, 2, 2, 4, 2, 1, 3, 2,
                          2, 3, 2, 3, 1, 2, 1, 4, 2, 1, 2, 2, 4, 1, 3, 4, 2, 3, 1, 1, 4, 1,
                          4, 2, 3, 2, 4, 4, 3, 2, 1, 3, 1, 1, 1, 1, 4, 4, 1, 3, 1, 2, 3, 1,
                          4, 3, 3, 3, 2, 3, 1, 3, 2, 2, 2, 3, 4, 3, 4, 3, 3, 4, 2, 2, 3, 3,
                          3, 1, 2, 3, 1, 1, 4, 2, 1, 2, 4, 4],
                         [2, 4, 4, 2, 1, 3, 4, 4, 1, 1, 2, 3, 3, 3, 1, 1, 2, 2, 4, 4, 4, 4,
                          4, 4, 1, 3, 4, 2, 4, 1, 2, 3, 2, 4, 3, 1, 2, 2, 1, 4, 2, 1, 1, 4,
                          3, 4, 1, 3, 2, 3, 3, 4, 1, 2, 2, 3, 4, 3, 2, 3, 3, 2, 1, 2, 4, 1,
                          4, 2, 3, 4, 3, 4, 4, 3, 1, 3, 3, 2, 2, 3, 2, 1, 2, 3, 4, 1, 4, 3,
                          2, 3, 4, 1, 1, 1, 4, 4, 1, 1, 2, 4],
                         [1, 3, 1, 1, 4, 4, 1, 3, 4, 4, 4, 4, 3, 1, 3, 1, 1, 3, 2, 1, 3, 2,
                          2, 2, 3, 1, 3, 4, 3, 4, 3, 4, 2, 2, 3, 1, 4, 3, 1, 1, 2, 4, 2, 4,
                          1, 2, 4, 1, 1, 2, 1, 3, 3, 1, 1, 2, 3, 3, 4, 4, 4, 1, 2, 3, 1, 3,
                          1, 3, 3, 3, 4, 1, 2, 2, 1, 1, 1, 2, 2, 1, 4, 1, 1, 2, 1, 2, 2, 1,
                          2, 1, 2, 2, 1, 4, 4, 2, 1, 2, 3, 3],
                         [1, 2, 4, 2, 2, 3, 1, 4, 4, 1, 4, 4, 4, 4, 4, 2, 2, 3, 1, 1, 2, 1,
                          1, 1, 4, 1, 3, 4, 3, 4, 2, 2, 4, 4, 3, 1, 3, 3, 1, 4, 2, 3, 3, 2,
                          3, 4, 1, 3, 3, 4, 4, 2, 4, 1, 1, 1, 4, 4, 2, 2, 2, 4, 1, 1, 1, 4,
                          3, 4, 3, 4, 1, 1, 4, 2, 1, 2, 3, 2, 2, 3, 2, 4, 3, 4, 4, 2, 1, 1,
                          3, 4, 1, 2, 4, 4, 1, 1, 2, 3, 2, 1],
                         [2, 2, 3, 1, 1, 2, 2, 3, 2, 4, 2, 3, 3, 3, 2, 2, 1, 3, 4, 3, 4, 4,
                          1, 1, 3, 4, 3, 4, 4, 1, 2, 1, 2, 4, 1, 4, 2, 4, 4, 1, 3, 1, 1, 4,
                          3, 2, 3, 2, 4, 1, 1, 4, 2, 1, 2, 4, 4, 3, 1, 3, 2, 3, 2, 2, 4, 1,
                          1, 2, 2, 1, 1, 4, 2, 2, 4, 3, 4, 2, 4, 4, 2, 1, 3, 4, 4, 4, 2, 4,
                          3, 3, 2, 2, 3, 3, 4, 1, 4, 4, 1, 1],
                         [2, 4, 4, 4, 1, 4, 4, 2, 2, 4, 3, 4, 4, 1, 1, 1, 2, 1, 3, 1, 4, 4,
                          2, 3, 4, 3, 4, 3, 1, 3, 2, 4, 1, 2, 3, 2, 2, 4, 4, 2, 3, 3, 1, 4,
                          4, 2, 4, 3, 3, 3, 4, 1, 1, 4, 1, 4, 2, 3, 3, 2, 3, 2, 4, 4, 3, 3,
                          1, 2, 4, 2, 1, 3, 3, 3, 1, 1, 4, 1, 3, 4, 2, 2, 3, 4, 4, 1, 4, 2,
                          1, 1, 4, 2, 3, 1, 3, 3, 1, 3, 3, 4],
                         [3, 2, 4, 1, 2, 2, 2, 3, 2, 2, 3, 3, 1, 3, 3, 2, 4, 1, 1, 1, 4, 1,
                          2, 2, 1, 1, 3, 3, 3, 1, 3, 4, 3, 4, 1, 2, 4, 2, 2, 3, 4, 2, 3, 2,
                          2, 2, 2, 2, 3, 4, 2, 1, 2, 4, 1, 3, 1, 1, 4, 1, 3, 3, 1, 3, 4, 1,
                          2, 1, 4, 4, 3, 4, 3, 3, 2, 4, 3, 4, 4, 4, 1, 2, 4, 3, 1, 4, 2, 3,
                          3, 3, 1, 1, 2, 2, 1, 2, 1, 1, 2, 1],
                         [3, 3, 3, 2, 3, 1, 2, 3, 3, 1, 3, 4, 4, 3, 3, 3, 1, 1, 1, 3, 1, 1,
                          4, 4, 3, 4, 1, 3, 2, 4, 2, 4, 4, 2, 4, 3, 4, 2, 2, 4, 4, 4, 2, 2,
                          1, 1, 1, 3, 4, 2, 2, 4, 2, 4, 3, 1, 4, 3, 4, 3, 2, 3, 2, 3, 1, 1,
                          2, 3, 2, 3, 2, 1, 3, 1, 2, 2, 1, 4, 1, 1, 2, 1, 3, 1, 3, 1, 1, 2,
                          2, 3, 2, 4, 1, 1, 3, 3, 2, 3, 3, 1],
                         [1, 2, 4, 4, 4, 2, 1, 4, 4, 4, 4, 1, 2, 4, 3, 2, 2, 2, 2, 4, 2, 1,
                          3, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 4, 1, 3, 2, 4, 2, 2, 2, 1,
                          2, 3, 3, 2, 1, 3, 3, 2, 4, 3, 1, 3, 3, 1, 2, 2, 3, 3, 3, 3, 2, 1,
                          3, 1, 3, 3, 1, 1, 4, 1, 4, 3, 1, 4, 4, 1, 2, 2, 3, 1, 3, 4, 3, 4,
                          3, 1, 4, 2, 4, 1, 2, 1, 1, 3, 2, 3],
                         [2, 3, 2, 1, 1, 2, 2, 2, 3, 1, 1, 1, 1, 3, 3, 1, 3, 2, 3, 2, 2, 4,
                          4, 3, 4, 1, 4, 4, 4, 4, 2, 4, 4, 1, 1, 2, 2, 1, 2, 3, 4, 2, 2, 3,
                          4, 3, 2, 2, 1, 2, 1, 3, 4, 1, 1, 4, 4, 3, 1, 3, 4, 4, 1, 1, 2, 3,
                          2, 4, 4, 3, 1, 3, 2, 2, 2, 2, 4, 4, 1, 1, 1, 3, 2, 1, 3, 1, 1, 1,
                          2, 3, 2, 4, 3, 4, 4, 3, 2, 3, 4, 4],
                         [1, 1, 2, 2, 2, 4, 2, 4, 4, 4, 2, 4, 2, 3, 1, 2, 1, 2, 1, 3, 4, 2,
                          4, 4, 2, 3, 1, 3, 3, 1, 2, 4, 1, 4, 2, 3, 3, 3, 1, 3, 4, 4, 2, 3,
                          4, 2, 4, 3, 4, 3, 1, 3, 2, 3, 3, 4, 4, 2, 4, 3, 1, 4, 2, 2, 4, 3,
                          3, 3, 4, 1, 3, 2, 3, 2, 1, 3, 4, 4, 4, 3, 3, 1, 3, 3, 1, 4, 3, 4,
                          1, 2, 3, 4, 3, 1, 3, 1, 4, 4, 2, 4],
                         [1, 4, 1, 2, 3, 3, 2, 1, 1, 4, 3, 2, 1, 2, 2, 3, 2, 2, 1, 1, 1, 4,
                          1, 3, 3, 1, 1, 1, 4, 2, 2, 3, 4, 3, 4, 4, 4, 4, 3, 3, 1, 3, 2, 4,
                          1, 4, 4, 1, 4, 2, 3, 4, 4, 2, 2, 3, 1, 3, 1, 1, 2, 4, 2, 1, 3, 1,
                          3, 3, 2, 3, 3, 2, 3, 3, 2, 2, 3, 2, 2, 4, 4, 2, 4, 4, 3, 2, 4, 3,
                          4, 4, 1, 3, 1, 3, 3, 1, 4, 2, 2, 2],
                         [2, 1, 2, 3, 2, 2, 3, 2, 1, 4, 3, 2, 2, 1, 1, 1, 3, 1, 3, 2, 3, 3,
                          2, 1, 1, 1, 3, 3, 4, 2, 4, 3, 1, 4, 3, 4, 2, 1, 1, 1, 2, 3, 2, 4,
                          1, 4, 2, 3, 1, 2, 1, 2, 3, 3, 3, 1, 1, 2, 2, 3, 2, 1, 2, 1, 4, 2,
                          1, 3, 2, 2, 4, 3, 4, 1, 3, 4, 3, 3, 2, 3, 1, 1, 1, 4, 2, 1, 2, 2,
                          3, 2, 2, 4, 3, 2, 4, 3, 3, 4, 1, 4],
                         [3, 1, 3, 3, 2, 4, 1, 1, 4, 2, 3, 2, 1, 4, 3, 1, 2, 2, 2, 1, 3, 4,
                          2, 4, 3, 3, 1, 1, 1, 1, 4, 1, 1, 1, 2, 3, 3, 2, 1, 2, 2, 3, 3, 1,
                          2, 1, 1, 1, 4, 3, 2, 1, 1, 1, 3, 4, 4, 2, 1, 4, 4, 3, 3, 1, 2, 3,
                          2, 4, 1, 2, 2, 3, 1, 3, 2, 1, 4, 3, 1, 2, 2, 2, 4, 4, 2, 2, 2, 3,
                          1, 3, 4, 3, 2, 1, 3, 2, 1, 2, 3, 4],
                         [3, 3, 1, 3, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 1, 4, 1, 1, 1, 4, 1, 3,
                          3, 4, 3, 1, 3, 1, 1, 4, 1, 3, 1, 3, 2, 2, 4, 3, 2, 4, 3, 1, 1, 2,
                          1, 1, 1, 1, 3, 1, 4, 2, 3, 4, 3, 1, 3, 1, 1, 3, 2, 3, 2, 1, 2, 2,
                          3, 2, 1, 4, 4, 2, 2, 3, 1, 3, 2, 4, 2, 4, 2, 3, 3, 2, 3, 1, 4, 3,
                          3, 3, 1, 3, 4, 3, 1, 2, 1, 3, 1, 4],
                         [3, 2, 4, 4, 3, 4, 2, 2, 1, 3, 2, 2, 4, 1, 2, 3, 4, 1, 4, 1, 2, 2,
                          2, 4, 1, 3, 2, 1, 4, 3, 1, 2, 4, 2, 2, 3, 1, 3, 3, 1, 3, 2, 4, 1,
                          3, 2, 4, 3, 4, 4, 4, 3, 3, 4, 4, 3, 2, 1, 4, 3, 3, 1, 2, 4, 1, 2,
                          3, 3, 4, 2, 4, 4, 2, 2, 1, 4, 1, 3, 3, 1, 1, 1, 2, 1, 1, 4, 3, 2,
                          4, 1, 1, 2, 2, 1, 3, 4, 4, 2, 2, 1],
                         [2, 3, 2, 2, 2, 1, 3, 4, 3, 2, 3, 3, 2, 1, 3, 1, 3, 4, 4, 2, 3, 3,
                          3, 1, 3, 1, 2, 2, 4, 3, 2, 4, 1, 3, 4, 2, 4, 4, 4, 3, 4, 2, 4, 4,
                          1, 4, 4, 3, 4, 2, 3, 4, 2, 3, 2, 1, 4, 4, 1, 1, 4, 2, 3, 3, 3, 1,
                          1, 2, 3, 4, 3, 2, 1, 4, 1, 2, 3, 2, 1, 4, 2, 3, 1, 3, 1, 4, 2, 4,
                          1, 4, 2, 3, 4, 2, 4, 1, 3, 4, 1, 1],
                         [2, 3, 4, 2, 4, 3, 4, 2, 4, 3, 4, 4, 2, 3, 4, 1, 3, 3, 4, 1, 1, 2,
                          2, 2, 1, 2, 3, 4, 2, 2, 2, 1, 2, 1, 2, 1, 1, 3, 4, 4, 3, 1, 4, 1,
                          3, 3, 4, 2, 3, 2, 4, 2, 1, 2, 1, 2, 2, 3, 2, 2, 1, 4, 2, 1, 4, 2,
                          1, 1, 3, 2, 1, 3, 1, 3, 2, 3, 4, 1, 3, 2, 4, 2, 3, 1, 3, 4, 4, 2,
                          2, 2, 2, 4, 4, 4, 4, 3, 2, 4, 4, 4],
                         [3, 2, 2, 4, 1, 4, 2, 1, 4, 2, 2, 3, 4, 1, 3, 4, 4, 1, 2, 2, 3, 3,
                          2, 3, 4, 2, 2, 2, 4, 1, 1, 1, 4, 3, 2, 2, 4, 3, 3, 2, 4, 1, 3, 2,
                          1, 4, 3, 1, 1, 2, 4, 1, 4, 4, 1, 4, 2, 2, 3, 4, 4, 3, 4, 3, 1, 4,
                          4, 4, 1, 1, 3, 3, 3, 2, 1, 2, 2, 2, 3, 4, 4, 1, 1, 2, 4, 4, 3, 4,
                          3, 1, 3, 1, 3, 2, 3, 1, 1, 3, 4, 2],
                         [1, 4, 2, 2, 4, 2, 2, 3, 4, 1, 3, 2, 4, 2, 1, 3, 4, 1, 4, 3, 2, 2,
                          1, 3, 3, 2, 1, 4, 2, 1, 1, 2, 4, 2, 4, 4, 2, 4, 4, 3, 1, 2, 1, 1,
                          1, 2, 4, 3, 1, 4, 3, 4, 1, 2, 4, 2, 4, 1, 3, 3, 3, 4, 2, 1, 4, 3,
                          1, 2, 4, 1, 4, 3, 4, 3, 4, 4, 4, 3, 2, 1, 1, 2, 2, 2, 4, 3, 4, 4,
                          4, 2, 4, 2, 2, 3, 1, 2, 2, 1, 4, 3],
                         [3, 2, 1, 2, 1, 4, 2, 3, 1, 2, 1, 2, 1, 2, 4, 3, 4, 1, 3, 2, 4, 2,
                          2, 3, 2, 3, 2, 1, 3, 3, 2, 4, 3, 2, 4, 1, 2, 4, 3, 1, 2, 4, 3, 1,
                          4, 1, 3, 2, 1, 3, 4, 3, 1, 1, 3, 2, 4, 3, 4, 2, 3, 3, 3, 1, 1, 4,
                          2, 2, 3, 3, 4, 4, 1, 2, 1, 3, 4, 3, 1, 4, 3, 1, 2, 1, 1, 3, 2, 3,
                          3, 4, 4, 3, 2, 3, 1, 4, 4, 3, 4, 3],
                         [1, 2, 2, 3, 2, 3, 2, 4, 4, 1, 1, 3, 4, 4, 2, 3, 1, 3, 4, 3, 4, 2,
                          2, 1, 3, 2, 2, 4, 1, 3, 3, 3, 3, 3, 4, 2, 1, 4, 1, 1, 3, 1, 1, 2,
                          4, 4, 1, 2, 4, 2, 1, 1, 4, 1, 3, 1, 2, 4, 4, 1, 4, 2, 2, 3, 2, 2,
                          3, 1, 3, 1, 3, 3, 2, 4, 3, 3, 2, 2, 2, 2, 1, 3, 2, 2, 4, 2, 4, 1,
                          2, 1, 2, 4, 4, 2, 3, 4, 4, 1, 3, 4],
                         [1, 2, 2, 1, 4, 1, 2, 2, 1, 2, 1, 1, 4, 4, 2, 4, 3, 4, 3, 3, 3, 4,
                          2, 1, 1, 1, 2, 4, 4, 2, 2, 3, 4, 4, 1, 4, 1, 4, 1, 4, 1, 1, 2, 2,
                          1, 3, 4, 1, 1, 3, 4, 3, 3, 1, 4, 2, 4, 3, 2, 4, 1, 1, 2, 1, 3, 1,
                          3, 2, 1, 2, 4, 1, 3, 2, 2, 1, 2, 2, 3, 1, 4, 2, 4, 1, 4, 4, 4, 3,
                          1, 3, 3, 4, 4, 1, 4, 4, 2, 4, 4, 1],
                         [1, 2, 1, 3, 4, 1, 4, 2, 1, 1, 3, 3, 2, 3, 3, 2, 1, 4, 3, 3, 3, 3,
                          4, 1, 1, 2, 3, 3, 4, 1, 1, 1, 2, 3, 3, 4, 2, 4, 1, 1, 1, 1, 2, 2,
                          2, 2, 2, 1, 1, 1, 2, 1, 2, 4, 1, 3, 4, 1, 3, 1, 1, 4, 3, 2, 4, 4,
                          2, 2, 2, 4, 4, 1, 1, 4, 3, 2, 2, 4, 3, 1, 2, 4, 4, 3, 3, 4, 4, 3,
                          3, 4, 1, 4, 3, 1, 3, 4, 3, 4, 4, 1],
                         [3, 1, 2, 1, 3, 3, 3, 1, 2, 2, 3, 1, 3, 2, 1, 1, 2, 2, 3, 4, 2, 2,
                          3, 3, 3, 3, 2, 4, 4, 1, 3, 3, 1, 1, 4, 3, 4, 1, 4, 4, 2, 1, 2, 1,
                          2, 1, 1, 2, 1, 2, 4, 1, 3, 4, 1, 4, 1, 3, 4, 2, 1, 3, 1, 3, 4, 4,
                          4, 1, 3, 1, 3, 3, 1, 4, 1, 3, 3, 4, 1, 1, 3, 3, 2, 2, 3, 4, 4, 1,
                          1, 2, 4, 4, 1, 2, 3, 4, 1, 2, 3, 3],
                         [2, 4, 2, 1, 2, 2, 3, 1, 3, 4, 4, 2, 1, 2, 3, 3, 2, 2, 2, 2, 2, 1,
                          4, 2, 1, 1, 1, 1, 3, 3, 3, 2, 4, 4, 1, 1, 4, 3, 3, 1, 2, 2, 4, 1,
                          3, 3, 4, 2, 1, 1, 2, 4, 4, 2, 3, 3, 1, 1, 1, 4, 3, 3, 4, 2, 3, 1,
                          3, 2, 2, 3, 2, 1, 1, 4, 3, 2, 4, 2, 1, 2, 3, 1, 3, 3, 4, 2, 2, 1,
                          1, 4, 1, 3, 2, 3, 4, 1, 4, 1, 3, 3],
                         [1, 2, 3, 2, 2, 1, 3, 3, 1, 2, 3, 4, 2, 1, 2, 4, 3, 2, 3, 2, 3, 4,
                          3, 4, 4, 2, 4, 4, 3, 3, 4, 1, 4, 1, 4, 4, 3, 4, 2, 3, 4, 2, 4, 2,
                          2, 3, 2, 1, 3, 3, 3, 3, 1, 1, 1, 2, 1, 1, 1, 3, 1, 2, 4, 3, 1, 3,
                          1, 4, 1, 2, 1, 1, 1, 1, 1, 3, 4, 4, 2, 3, 4, 4, 3, 4, 2, 1, 4, 4,
                          1, 3, 2, 1, 1, 1, 4, 3, 1, 1, 3, 4],
                         [3, 4, 2, 2, 1, 3, 4, 2, 3, 2, 4, 2, 4, 2, 1, 3, 3, 1, 3, 1, 1, 3,
                          4, 1, 2, 4, 2, 3, 2, 2, 4, 4, 2, 2, 2, 4, 3, 2, 3, 3, 2, 2, 4, 1,
                          3, 4, 2, 1, 3, 1, 3, 4, 1, 2, 4, 1, 4, 2, 2, 2, 3, 3, 2, 4, 2, 4,
                          1, 2, 2, 1, 2, 4, 4, 2, 1, 4, 1, 1, 1, 3, 2, 1, 1, 1, 3, 4, 2, 1,
                          4, 2, 1, 1, 3, 1, 1, 1, 1, 4, 3, 1],
                         [2, 2, 4, 4, 3, 4, 1, 4, 4, 1, 2, 2, 2, 1, 3, 2, 3, 2, 1, 2, 3, 1,
                          2, 2, 2, 1, 4, 1, 2, 1, 3, 3, 3, 3, 3, 4, 4, 3, 1, 4, 3, 2, 1, 4,
                          1, 3, 3, 1, 4, 2, 3, 1, 2, 1, 4, 1, 1, 1, 4, 2, 4, 1, 1, 2, 2, 4,
                          3, 3, 1, 4, 4, 3, 1, 3, 1, 3, 3, 1, 2, 1, 3, 4, 1, 2, 3, 4, 4, 4,
                          3, 1, 1, 3, 2, 4, 2, 1, 2, 1, 1, 4],
                         [2, 3, 2, 3, 2, 4, 2, 2, 3, 4, 2, 1, 2, 1, 4, 2, 1, 2, 2, 1, 2, 1,
                          4, 1, 3, 3, 3, 2, 4, 1, 1, 1, 1, 3, 3, 2, 2, 3, 1, 4, 4, 4, 4, 3,
                          2, 4, 1, 2, 1, 1, 2, 3, 4, 4, 1, 2, 4, 4, 2, 2, 3, 2, 1, 3, 1, 3,
                          3, 4, 2, 2, 4, 4, 4, 1, 4, 4, 2, 4, 4, 2, 2, 2, 2, 1, 1, 2, 2, 4,
                          2, 3, 2, 2, 4, 4, 4, 2, 3, 2, 2, 2],
                         [2, 4, 2, 3, 4, 3, 2, 3, 3, 2, 2, 1, 3, 1, 4, 4, 4, 4, 2, 2, 3, 4,
                          3, 1, 4, 4, 3, 1, 1, 2, 3, 1, 2, 2, 1, 2, 3, 4, 1, 3, 1, 3, 4, 4,
                          3, 4, 1, 2, 4, 3, 1, 2, 2, 4, 2, 3, 3, 3, 2, 2, 3, 1, 3, 2, 3, 2,
                          4, 2, 1, 3, 2, 1, 4, 4, 1, 2, 2, 2, 1, 4, 3, 3, 4, 1, 4, 2, 3, 2,
                          2, 2, 2, 4, 1, 3, 4, 1, 3, 2, 2, 1],
                         [1, 2, 1, 3, 1, 1, 4, 1, 3, 1, 2, 3, 4, 4, 2, 4, 2, 4, 2, 4, 1, 1,
                          3, 4, 4, 2, 3, 2, 4, 4, 3, 4, 3, 4, 3, 4, 4, 2, 2, 4, 4, 3, 1, 3,
                          1, 4, 4, 2, 1, 1, 4, 1, 2, 2, 3, 1, 4, 2, 3, 1, 4, 3, 2, 1, 1, 3,
                          1, 1, 3, 2, 4, 3, 2, 4, 2, 1, 3, 3, 3, 4, 1, 2, 4, 3, 2, 1, 1, 1,
                          2, 4, 1, 4, 1, 1, 1, 4, 4, 1, 2, 3],
                         [3, 4, 1, 2, 1, 3, 1, 4, 4, 3, 4, 4, 2, 2, 4, 2, 4, 4, 1, 2, 4, 1,
                          3, 1, 4, 3, 4, 1, 3, 3, 4, 3, 4, 1, 2, 3, 4, 3, 2, 1, 1, 1, 1, 1,
                          1, 3, 2, 4, 1, 4, 2, 4, 3, 1, 1, 3, 4, 1, 1, 3, 3, 4, 4, 3, 1, 3,
                          2, 4, 1, 4, 2, 1, 3, 3, 2, 2, 1, 3, 1, 1, 2, 3, 1, 1, 1, 1, 1, 4,
                          2, 1, 4, 2, 4, 2, 4, 4, 3, 1, 4, 1],
                         [3, 1, 4, 4, 1, 2, 1, 3, 1, 3, 2, 1, 2, 4, 4, 4, 3, 2, 3, 2, 2, 2,
                          1, 1, 1, 2, 2, 1, 4, 3, 3, 2, 4, 3, 1, 3, 4, 3, 3, 2, 1, 1, 1, 2,
                          4, 3, 1, 1, 2, 2, 3, 3, 1, 1, 3, 3, 1, 1, 4, 1, 1, 3, 1, 2, 2, 3,
                          1, 3, 1, 3, 2, 1, 4, 1, 1, 3, 2, 2, 2, 4, 1, 3, 1, 3, 2, 3, 1, 2,
                          1, 3, 4, 1, 1, 2, 4, 4, 2, 3, 2, 4],
                         [1, 1, 4, 1, 4, 4, 1, 2, 1, 2, 2, 3, 2, 3, 4, 3, 4, 4, 4, 3, 3, 1,
                          4, 3, 1, 2, 3, 1, 3, 1, 4, 3, 3, 4, 3, 3, 3, 1, 2, 1, 4, 4, 2, 2,
                          4, 2, 2, 4, 1, 1, 1, 2, 4, 4, 2, 1, 1, 1, 3, 1, 1, 3, 3, 1, 1, 2,
                          4, 2, 1, 1, 1, 3, 2, 4, 1, 3, 3, 3, 2, 2, 4, 1, 3, 1, 1, 1, 1, 3,
                          3, 2, 2, 2, 4, 2, 3, 3, 1, 2, 2, 2],
                         [3, 3, 1, 1, 2, 1, 4, 1, 2, 1, 4, 1, 3, 2, 1, 1, 4, 2, 2, 1, 3, 4,
                          2, 4, 3, 2, 4, 4, 2, 4, 1, 2, 2, 1, 4, 3, 1, 1, 1, 2, 2, 1, 4, 4,
                          4, 3, 3, 1, 3, 4, 4, 3, 3, 1, 4, 2, 3, 3, 1, 3, 2, 1, 4, 2, 1, 2,
                          2, 1, 4, 4, 1, 1, 1, 1, 4, 4, 3, 1, 1, 4, 3, 4, 3, 4, 2, 3, 1, 4,
                          1, 4, 1, 4, 4, 2, 2, 4, 4, 4, 4, 4],
                         [1, 3, 1, 2, 4, 2, 4, 3, 3, 4, 1, 3, 3, 4, 2, 2, 2, 4, 1, 4, 1, 3,
                          4, 4, 2, 3, 2, 3, 3, 2, 1, 1, 4, 4, 2, 1, 4, 4, 3, 3, 3, 3, 1, 1,
                          4, 1, 1, 4, 2, 4, 3, 2, 4, 3, 4, 3, 3, 4, 3, 1, 3, 3, 1, 3, 1, 1,
                          1, 2, 4, 2, 3, 2, 4, 3, 2, 4, 3, 4, 3, 2, 4, 2, 2, 4, 3, 4, 3, 4,
                          4, 4, 1, 2, 2, 2, 4, 3, 2, 4, 4, 3],
                         [4, 3, 3, 1, 3, 3, 1, 4, 2, 1, 4, 1, 3, 1, 1, 1, 1, 4, 2, 4, 4, 1,
                          1, 3, 4, 4, 3, 4, 4, 3, 4, 2, 4, 2, 4, 3, 2, 3, 3, 3, 4, 3, 4, 1,
                          3, 2, 2, 3, 2, 2, 2, 4, 4, 2, 1, 3, 4, 4, 3, 2, 3, 2, 3, 3, 4, 4,
                          2, 2, 3, 3, 1, 2, 1, 1, 1, 3, 3, 3, 2, 2, 3, 2, 3, 3, 1, 3, 3, 1,
                          2, 2, 3, 1, 1, 1, 2, 3, 2, 2, 2, 3],
                         [3, 4, 4, 2, 2, 2, 1, 2, 4, 1, 3, 4, 4, 2, 2, 2, 4, 4, 3, 1, 1, 2,
                          1, 2, 3, 4, 1, 4, 4, 2, 4, 4, 3, 4, 3, 2, 1, 2, 2, 2, 2, 2, 4, 4,
                          2, 2, 1, 2, 3, 2, 3, 3, 1, 2, 3, 1, 3, 2, 2, 2, 4, 1, 4, 4, 3, 2,
                          3, 4, 1, 1, 3, 4, 1, 1, 4, 2, 4, 1, 4, 2, 4, 1, 3, 4, 2, 1, 1, 4,
                          2, 4, 4, 4, 4, 3, 1, 2, 3, 3, 1, 2],
                         [1, 2, 4, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 4, 2, 4, 2,
                          2, 1, 1, 4, 2, 2, 2, 2, 1, 2, 4, 1, 1, 1, 3, 4, 4, 3, 1, 4, 2, 3,
                          1, 4, 4, 1, 2, 3, 1, 1, 2, 4, 4, 4, 4, 3, 4, 1, 1, 2, 3, 4, 2, 2,
                          2, 2, 4, 3, 1, 3, 4, 3, 3, 1, 4, 2, 3, 2, 1, 2, 2, 4, 1, 2, 3, 1,
                          3, 3, 1, 1, 2, 2, 2, 1, 2, 3, 1, 4],
                         [3, 3, 4, 4, 3, 2, 4, 1, 1, 4, 1, 2, 3, 4, 3, 3, 3, 1, 3, 3, 2, 4,
                          4, 3, 3, 1, 1, 2, 1, 1, 2, 3, 2, 1, 2, 1, 3, 4, 2, 2, 3, 1, 2, 1,
                          3, 4, 1, 3, 4, 2, 2, 2, 2, 2, 3, 4, 3, 3, 1, 1, 2, 2, 4, 1, 4, 3,
                          4, 2, 1, 4, 3, 1, 3, 4, 3, 1, 4, 3, 2, 2, 1, 2, 1, 3, 3, 4, 2, 2,
                          4, 2, 4, 1, 1, 2, 1, 2, 2, 3, 1, 3],
                         [1, 3, 2, 1, 1, 3, 3, 4, 1, 4, 2, 1, 1, 4, 3, 2, 4, 3, 1, 3, 3, 4,
                          3, 3, 1, 4, 2, 3, 2, 4, 4, 1, 4, 1, 1, 4, 3, 4, 3, 4, 2, 3, 3, 4,
                          4, 2, 2, 3, 3, 2, 2, 2, 2, 2, 2, 4, 3, 1, 3, 1, 2, 3, 3, 2, 4, 2,
                          1, 4, 2, 2, 4, 4, 3, 2, 4, 1, 3, 4, 2, 3, 4, 3, 2, 4, 2, 4, 3, 1,
                          1, 1, 3, 2, 2, 2, 1, 2, 4, 3, 3, 4],
                         [1, 1, 4, 2, 1, 2, 3, 1, 4, 2, 4, 1, 3, 1, 1, 2, 4, 3, 4, 4, 3, 3,
                          3, 2, 2, 4, 2, 2, 2, 4, 2, 1, 1, 2, 4, 1, 4, 1, 4, 2, 3, 1, 2, 2,
                          1, 2, 3, 1, 2, 3, 2, 1, 3, 3, 4, 3, 1, 3, 1, 3, 1, 3, 2, 1, 4, 3,
                          1, 1, 1, 1, 4, 3, 2, 2, 2, 2, 4, 4, 3, 1, 2, 4, 1, 4, 4, 1, 4, 3,
                          4, 4, 2, 1, 2, 4, 2, 2, 3, 4, 3, 3],
                         [3, 3, 4, 3, 4, 4, 4, 2, 3, 1, 3, 2, 3, 1, 2, 3, 3, 2, 2, 2, 4, 4,
                          2, 3, 2, 3, 1, 1, 3, 4, 3, 2, 3, 4, 1, 1, 4, 3, 4, 4, 1, 2, 1, 1,
                          4, 4, 4, 2, 3, 2, 4, 4, 1, 1, 2, 2, 3, 2, 1, 1, 4, 3, 3, 3, 4, 3,
                          3, 3, 2, 2, 4, 2, 3, 3, 2, 3, 4, 2, 4, 1, 1, 1, 4, 4, 3, 2, 3, 3,
                          3, 1, 3, 2, 4, 1, 2, 1, 3, 1, 3, 3],
                         [3, 3, 2, 3, 3, 2, 4, 4, 3, 4, 3, 3, 3, 4, 3, 1, 2, 3, 3, 4, 3, 1,
                          2, 2, 1, 2, 2, 4, 1, 4, 2, 3, 3, 2, 4, 1, 1, 1, 2, 4, 1, 3, 4, 1,
                          1, 4, 4, 4, 1, 4, 2, 3, 3, 2, 3, 3, 2, 1, 4, 2, 1, 3, 4, 3, 4, 2,
                          3, 1, 4, 3, 3, 2, 2, 4, 1, 2, 2, 1, 4, 4, 4, 2, 2, 2, 2, 1, 2, 4,
                          4, 4, 3, 2, 3, 2, 3, 4, 2, 4, 1, 3],
                         [1, 4, 2, 3, 3, 1, 3, 4, 4, 1, 3, 4, 3, 2, 1, 3, 2, 1, 1, 4, 1, 3,
                          4, 2, 4, 1, 1, 3, 2, 2, 3, 1, 2, 2, 3, 4, 3, 4, 4, 3, 1, 4, 2, 4,
                          1, 1, 3, 3, 1, 4, 1, 1, 2, 3, 2, 3, 1, 2, 4, 1, 1, 3, 3, 3, 2, 4,
                          4, 4, 3, 2, 4, 4, 3, 3, 2, 3, 4, 3, 3, 1, 1, 3, 4, 4, 1, 3, 1, 2,
                          4, 3, 2, 4, 4, 3, 3, 4, 2, 1, 3, 4],
                         [1, 4, 3, 1, 1, 3, 3, 3, 3, 4, 3, 4, 4, 1, 3, 4, 1, 3, 1, 1, 4, 2,
                          4, 2, 4, 2, 2, 3, 3, 3, 3, 2, 1, 3, 3, 1, 1, 4, 1, 4, 1, 4, 3, 1,
                          4, 1, 1, 3, 3, 2, 1, 1, 4, 4, 3, 2, 1, 2, 4, 4, 2, 3, 2, 4, 4, 1,
                          2, 2, 3, 1, 3, 2, 4, 2, 4, 4, 2, 3, 4, 4, 4, 4, 2, 3, 1, 1, 2, 1,
                          2, 2, 2, 3, 4, 4, 4, 4, 4, 2, 2, 4],
                         [1, 1, 1, 2, 1, 1, 4, 3, 2, 1, 2, 3, 4, 4, 4, 2, 3, 3, 1, 2, 3, 4,
                          1, 3, 3, 2, 3, 3, 3, 1, 2, 1, 3, 1, 4, 4, 3, 3, 3, 4, 1, 4, 1, 1,
                          4, 2, 4, 2, 3, 3, 2, 3, 3, 2, 3, 2, 4, 4, 4, 1, 1, 2, 1, 1, 4, 4,
                          3, 3, 4, 1, 3, 4, 1, 4, 4, 2, 1, 1, 3, 3, 1, 3, 1, 1, 3, 1, 4, 4,
                          4, 4, 2, 2, 1, 2, 1, 3, 2, 1, 1, 3],
                         [1, 3, 4, 1, 2, 3, 2, 3, 4, 4, 2, 3, 3, 1, 2, 4, 3, 4, 3, 1, 3, 3,
                          3, 1, 4, 2, 2, 1, 3, 4, 3, 4, 1, 3, 4, 4, 3, 2, 1, 1, 2, 3, 1, 3,
                          4, 4, 4, 1, 3, 1, 3, 3, 3, 1, 4, 2, 2, 4, 4, 4, 1, 2, 2, 4, 4, 1,
                          3, 4, 2, 4, 2, 1, 4, 2, 1, 2, 4, 2, 2, 4, 2, 3, 1, 1, 1, 1, 2, 4,
                          2, 2, 4, 4, 2, 4, 2, 3, 4, 2, 2, 2],
                         [3, 2, 2, 2, 4, 3, 2, 2, 4, 1, 2, 4, 2, 3, 2, 3, 2, 1, 2, 2, 4, 2,
                          2, 4, 4, 1, 3, 2, 2, 4, 4, 1, 2, 2, 4, 2, 1, 4, 1, 1, 3, 4, 1, 2,
                          3, 1, 2, 3, 2, 3, 4, 4, 4, 3, 1, 2, 3, 2, 1, 4, 1, 2, 3, 4, 3, 1,
                          1, 3, 2, 4, 1, 4, 2, 1, 1, 3, 2, 4, 1, 3, 3, 1, 3, 1, 2, 1, 4, 2,
                          1, 1, 1, 1, 2, 3, 4, 3, 2, 4, 4, 1],
                         [1, 1, 1, 1, 1, 1, 4, 3, 1, 4, 4, 4, 2, 2, 4, 2, 2, 3, 1, 3, 2, 3,
                          1, 3, 4, 4, 3, 2, 2, 1, 2, 4, 1, 1, 1, 3, 3, 1, 3, 1, 4, 2, 4, 2,
                          4, 4, 1, 2, 1, 2, 2, 4, 3, 4, 1, 3, 3, 1, 4, 2, 1, 1, 1, 3, 4, 2,
                          4, 3, 1, 4, 3, 4, 3, 2, 3, 3, 2, 1, 3, 2, 3, 1, 2, 4, 4, 3, 2, 3,
                          1, 4, 2, 3, 1, 1, 2, 1, 2, 2, 3, 2],
                         [2, 4, 3, 2, 2, 1, 1, 2, 3, 4, 2, 3, 1, 4, 3, 3, 1, 2, 2, 1, 4, 2,
                          4, 1, 4, 3, 3, 2, 3, 2, 2, 3, 3, 4, 4, 4, 1, 3, 2, 2, 3, 2, 1, 4,
                          4, 3, 2, 2, 3, 1, 4, 3, 4, 4, 2, 3, 2, 2, 3, 3, 3, 2, 3, 2, 4, 1,
                          1, 1, 3, 1, 4, 4, 3, 4, 1, 1, 2, 2, 4, 2, 2, 4, 1, 2, 1, 2, 4, 4,
                          2, 1, 4, 4, 1, 1, 3, 1, 1, 2, 1, 3],
                         [3, 1, 2, 3, 2, 3, 4, 4, 4, 1, 3, 1, 1, 2, 2, 1, 2, 4, 2, 3, 2, 3,
                          4, 1, 3, 3, 3, 1, 2, 3, 1, 2, 4, 1, 3, 4, 2, 2, 4, 3, 4, 3, 3, 4,
                          3, 4, 4, 4, 3, 3, 4, 1, 3, 3, 2, 1, 3, 3, 3, 3, 1, 2, 2, 1, 2, 2,
                          4, 3, 3, 3, 4, 3, 1, 4, 4, 3, 2, 4, 2, 1, 2, 2, 3, 4, 4, 1, 3, 4,
                          1, 4, 3, 3, 4, 2, 4, 2, 1, 2, 1, 2],
                         [2, 1, 4, 2, 2, 1, 1, 4, 3, 2, 3, 4, 3, 4, 4, 3, 4, 1, 1, 1, 1, 1,
                          4, 1, 1, 4, 1, 4, 2, 4, 1, 3, 1, 3, 1, 4, 4, 1, 2, 3, 3, 1, 2, 4,
                          4, 4, 4, 1, 4, 3, 3, 1, 4, 1, 4, 2, 3, 3, 4, 4, 3, 4, 4, 1, 3, 3,
                          4, 4, 3, 2, 1, 4, 2, 1, 2, 1, 1, 2, 4, 4, 2, 3, 3, 1, 4, 4, 3, 1,
                          4, 3, 1, 4, 1, 3, 3, 2, 1, 1, 3, 2],
                         [2, 1, 3, 4, 4, 4, 4, 4, 1, 2, 1, 2, 4, 2, 1, 2, 4, 2, 4, 1, 4, 4,
                          2, 1, 1, 1, 1, 2, 4, 1, 3, 2, 1, 4, 3, 1, 4, 2, 1, 3, 3, 2, 3, 4,
                          1, 1, 4, 1, 4, 2, 3, 2, 4, 1, 2, 1, 2, 1, 4, 2, 1, 2, 3, 4, 1, 3,
                          3, 4, 1, 4, 2, 2, 3, 4, 2, 4, 3, 2, 2, 3, 3, 3, 4, 2, 4, 3, 4, 1,
                          3, 1, 4, 3, 1, 3, 2, 2, 1, 1, 3, 2],
                         [2, 2, 4, 4, 1, 2, 4, 4, 2, 1, 3, 2, 2, 4, 3, 1, 3, 3, 4, 3, 1, 3,
                          2, 1, 3, 1, 1, 3, 3, 3, 2, 4, 1, 2, 2, 3, 3, 3, 4, 3, 3, 3, 2, 4,
                          4, 1, 3, 1, 2, 4, 1, 3, 3, 3, 4, 4, 3, 3, 1, 2, 2, 2, 4, 1, 2, 2,
                          2, 2, 1, 3, 4, 1, 3, 2, 1, 2, 1, 1, 4, 3, 2, 3, 2, 4, 1, 4, 3, 2,
                          4, 3, 4, 3, 3, 1, 4, 4, 3, 1, 2, 3],
                         [3, 4, 3, 1, 3, 1, 3, 4, 4, 4, 3, 1, 1, 1, 3, 4, 3, 1, 1, 2, 2, 1,
                          1, 2, 4, 2, 1, 2, 1, 2, 3, 1, 4, 1, 2, 4, 3, 4, 2, 3, 2, 3, 2, 1,
                          4, 3, 2, 4, 1, 3, 1, 4, 4, 1, 4, 2, 4, 1, 2, 2, 4, 2, 2, 3, 2, 1,
                          1, 1, 1, 4, 1, 1, 2, 2, 1, 1, 4, 2, 3, 1, 3, 2, 2, 2, 4, 2, 3, 4,
                          3, 2, 4, 3, 3, 4, 4, 3, 4, 4, 4, 4],
                         [2, 1, 2, 4, 2, 1, 1, 3, 3, 3, 2, 4, 3, 2, 1, 3, 1, 2, 4, 3, 4, 4,
                          4, 3, 3, 1, 3, 2, 3, 3, 2, 4, 1, 2, 4, 2, 4, 2, 1, 2, 3, 2, 1, 3,
                          2, 1, 3, 4, 3, 1, 1, 4, 3, 2, 2, 4, 2, 2, 1, 3, 2, 3, 2, 1, 3, 1,
                          3, 1, 4, 4, 4, 2, 2, 2, 4, 3, 2, 4, 1, 2, 2, 1, 1, 3, 3, 1, 1, 3,
                          4, 1, 2, 1, 4, 3, 2, 2, 1, 3, 3, 2],
                         [2, 2, 1, 1, 4, 3, 2, 2, 1, 1, 3, 2, 4, 2, 2, 4, 1, 1, 1, 3, 3, 2,
                          4, 4, 1, 2, 1, 1, 4, 4, 1, 3, 3, 2, 3, 2, 4, 1, 4, 2, 1, 4, 3, 3,
                          4, 4, 2, 4, 1, 3, 4, 4, 2, 3, 2, 3, 4, 1, 4, 2, 4, 1, 3, 4, 3, 4,
                          3, 1, 3, 3, 1, 4, 2, 1, 2, 3, 4, 2, 3, 3, 1, 3, 4, 1, 3, 4, 1, 2,
                          3, 4, 3, 2, 3, 2, 4, 2, 2, 2, 3, 3],
                         [2, 3, 1, 3, 4, 3, 1, 4, 4, 1, 4, 3, 3, 4, 2, 4, 3, 4, 1, 3, 1, 3,
                          3, 2, 2, 4, 3, 3, 1, 2, 4, 1, 1, 4, 3, 1, 1, 4, 3, 4, 3, 2, 3, 1,
                          1, 2, 3, 2, 2, 3, 1, 1, 4, 3, 2, 2, 4, 1, 3, 2, 3, 2, 1, 2, 2, 4,
                          1, 1, 1, 2, 3, 4, 3, 1, 1, 4, 3, 1, 3, 1, 4, 3, 3, 3, 3, 3, 3, 4,
                          4, 4, 2, 2, 3, 1, 2, 1, 2, 2, 3, 4],
                         [3, 3, 4, 2, 2, 3, 2, 4, 2, 1, 4, 1, 2, 3, 3, 1, 4, 1, 4, 3, 2, 2,
                          1, 2, 4, 1, 2, 4, 2, 2, 1, 4, 4, 4, 3, 4, 4, 4, 3, 1, 3, 3, 3, 1,
                          2, 2, 1, 1, 1, 3, 2, 3, 4, 1, 1, 3, 2, 2, 4, 2, 4, 3, 4, 2, 4, 4,
                          4, 3, 4, 4, 3, 3, 4, 2, 3, 1, 2, 3, 1, 4, 3, 1, 1, 3, 2, 2, 3, 4,
                          2, 2, 3, 1, 2, 4, 4, 4, 1, 4, 1, 1],
                         [2, 2, 4, 1, 3, 4, 2, 2, 3, 3, 3, 4, 2, 3, 3, 1, 1, 3, 1, 3, 4, 3,
                          3, 3, 4, 3, 3, 2, 4, 2, 2, 3, 2, 4, 2, 4, 2, 4, 1, 3, 2, 1, 2, 2,
                          1, 1, 1, 1, 2, 4, 4, 3, 2, 2, 2, 3, 4, 4, 3, 1, 3, 3, 1, 3, 2, 3,
                          3, 1, 4, 1, 3, 3, 3, 1, 2, 1, 2, 4, 4, 1, 1, 2, 3, 2, 1, 4, 2, 4,
                          4, 4, 4, 4, 3, 1, 4, 2, 3, 3, 3, 1],
                         [3, 2, 3, 3, 1, 1, 2, 1, 1, 1, 1, 3, 3, 3, 3, 4, 1, 2, 2, 4, 1, 4,
                          1, 2, 4, 4, 1, 2, 2, 4, 3, 1, 4, 1, 2, 4, 1, 3, 2, 3, 4, 4, 1, 1,
                          1, 4, 3, 1, 4, 4, 2, 4, 3, 3, 4, 3, 3, 4, 4, 1, 4, 4, 3, 1, 4, 1,
                          2, 3, 4, 1, 3, 1, 4, 3, 4, 1, 4, 3, 1, 3, 2, 1, 2, 1, 1, 1, 3, 4,
                          2, 1, 1, 3, 4, 2, 1, 2, 3, 3, 1, 2],
                         [3, 3, 4, 3, 3, 1, 3, 2, 1, 4, 3, 4, 1, 1, 2, 3, 4, 1, 4, 4, 4, 1,
                          3, 4, 3, 1, 2, 3, 2, 2, 2, 1, 2, 2, 1, 4, 1, 4, 4, 4, 4, 3, 2, 2,
                          1, 2, 2, 3, 1, 3, 1, 1, 3, 3, 2, 4, 4, 2, 1, 1, 3, 3, 4, 3, 1, 4,
                          4, 4, 3, 1, 4, 1, 1, 2, 3, 1, 3, 3, 2, 4, 2, 1, 1, 3, 3, 4, 4, 1,
                          4, 4, 2, 4, 3, 3, 4, 3, 4, 2, 1, 4],
                         [3, 2, 4, 3, 1, 2, 3, 4, 1, 1, 1, 4, 1, 4, 2, 3, 3, 4, 1, 2, 1, 4,
                          3, 4, 3, 4, 2, 2, 1, 3, 4, 3, 4, 3, 2, 1, 2, 1, 2, 1, 3, 1, 4, 2,
                          4, 2, 1, 4, 4, 3, 1, 2, 3, 4, 2, 3, 2, 4, 2, 4, 1, 4, 4, 3, 1, 1,
                          3, 2, 4, 2, 2, 4, 2, 2, 4, 1, 3, 1, 3, 2, 2, 2, 2, 2, 3, 4, 1, 2,
                          4, 1, 4, 2, 2, 4, 4, 4, 1, 2, 4, 3],
                         [1, 3, 3, 3, 1, 3, 4, 1, 2, 4, 1, 3, 4, 2, 4, 3, 4, 1, 1, 3, 2, 1,
                          1, 2, 1, 3, 3, 3, 2, 2, 3, 2, 3, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2,
                          1, 2, 4, 3, 4, 1, 4, 1, 4, 2, 4, 3, 1, 2, 4, 3, 2, 4, 4, 3, 1, 4,
                          1, 2, 1, 4, 3, 4, 4, 1, 1, 1, 1, 3, 2, 3, 1, 2, 3, 2, 4, 2, 2, 4,
                          4, 1, 1, 3, 2, 2, 2, 4, 4, 4, 2, 2],
                         [3, 3, 3, 4, 3, 1, 4, 1, 4, 3, 1, 2, 3, 4, 1, 2, 1, 1, 3, 4, 4, 2,
                          2, 1, 4, 4, 4, 3, 3, 1, 4, 3, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 1, 2,
                          3, 1, 2, 1, 3, 1, 4, 4, 4, 2, 1, 2, 2, 3, 1, 2, 1, 4, 4, 3, 3, 4,
                          3, 4, 4, 4, 4, 3, 1, 3, 4, 2, 3, 2, 2, 4, 4, 4, 2, 4, 4, 3, 4, 1,
                          4, 2, 1, 1, 3, 1, 1, 1, 3, 2, 1, 3],
                         [4, 3, 1, 1, 2, 1, 1, 4, 4, 1, 1, 3, 2, 1, 2, 1, 1, 1, 1, 3, 1, 1,
                          2, 4, 2, 2, 1, 4, 4, 3, 1, 4, 2, 4, 4, 1, 2, 4, 1, 2, 1, 1, 2, 2,
                          1, 3, 2, 4, 4, 1, 4, 4, 3, 1, 4, 2, 4, 3, 2, 3, 3, 4, 1, 1, 2, 2,
                          4, 2, 4, 4, 4, 3, 1, 1, 2, 1, 1, 4, 4, 3, 4, 4, 1, 3, 2, 1, 1, 2,
                          2, 4, 4, 1, 4, 3, 2, 1, 3, 2, 4, 3],
                         [1, 3, 2, 4, 4, 1, 1, 3, 1, 3, 4, 1, 2, 1, 2, 1, 1, 1, 3, 1, 4, 3,
                          1, 4, 4, 2, 1, 2, 4, 3, 4, 2, 1, 4, 4, 2, 3, 2, 1, 4, 4, 3, 4, 1,
                          1, 1, 1, 2, 2, 3, 4, 4, 2, 4, 2, 2, 2, 1, 2, 2, 3, 2, 2, 4, 2, 1,
                          3, 3, 3, 3, 2, 2, 4, 4, 4, 4, 4, 2, 1, 4, 2, 4, 4, 3, 2, 1, 2, 1,
                          3, 2, 2, 3, 4, 4, 3, 3, 4, 2, 2, 4],
                         [2, 1, 4, 1, 3, 4, 3, 4, 2, 4, 3, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3,
                          1, 1, 1, 4, 2, 2, 2, 1, 3, 2, 1, 1, 3, 3, 4, 1, 2, 3, 2, 2, 4, 2,
                          2, 3, 2, 4, 1, 1, 4, 2, 4, 4, 4, 3, 1, 4, 4, 1, 2, 2, 2, 2, 2, 3,
                          3, 1, 1, 2, 4, 3, 3, 4, 4, 2, 4, 4, 2, 2, 3, 1, 1, 2, 4, 4, 3, 3,
                          1, 3, 2, 4, 3, 3, 4, 1, 4, 3, 4, 4],
                         [2, 4, 3, 1, 4, 4, 2, 2, 4, 1, 1, 1, 2, 3, 3, 3, 2, 2, 3, 1, 4, 2,
                          4, 3, 4, 3, 3, 2, 1, 2, 1, 3, 4, 4, 3, 1, 4, 1, 1, 1, 4, 3, 3, 2,
                          3, 2, 4, 2, 4, 2, 2, 4, 1, 4, 1, 2, 4, 3, 2, 3, 1, 3, 1, 3, 1, 4,
                          2, 2, 3, 4, 1, 3, 4, 2, 4, 2, 1, 4, 1, 1, 4, 4, 1, 2, 3, 3, 2, 1,
                          4, 2, 3, 2, 1, 2, 4, 1, 2, 1, 4, 4],
                         [1, 3, 3, 3, 4, 3, 2, 4, 3, 2, 4, 1, 1, 1, 3, 1, 3, 1, 4, 4, 3, 1,
                          2, 2, 3, 3, 1, 1, 2, 4, 1, 3, 2, 3, 3, 4, 4, 3, 4, 3, 4, 1, 4, 2,
                          2, 3, 3, 4, 2, 4, 1, 3, 3, 1, 4, 3, 1, 4, 4, 4, 2, 2, 4, 2, 2, 4,
                          2, 3, 4, 1, 4, 4, 1, 4, 3, 3, 2, 3, 3, 2, 1, 2, 3, 4, 4, 4, 1, 2,
                          1, 2, 3, 3, 4, 1, 2, 3, 2, 4, 1, 4],
                         [4, 2, 4, 1, 3, 2, 4, 3, 4, 1, 4, 2, 2, 1, 3, 2, 3, 2, 3, 4, 2, 3,
                          4, 3, 4, 4, 4, 2, 1, 1, 2, 2, 2, 1, 2, 2, 3, 2, 2, 4, 3, 3, 2, 2,
                          2, 1, 3, 4, 3, 2, 4, 4, 3, 3, 3, 3, 4, 2, 3, 4, 3, 4, 4, 1, 4, 2,
                          1, 3, 2, 1, 1, 2, 1, 2, 1, 2, 2, 3, 4, 3, 2, 3, 1, 3, 3, 1, 4, 2,
                          4, 3, 1, 2, 4, 2, 1, 2, 3, 4, 3, 4],
                         [4, 4, 2, 1, 2, 3, 3, 2, 4, 4, 3, 1, 1, 4, 2, 1, 3, 1, 1, 2, 3, 4,
                          2, 3, 2, 3, 1, 2, 2, 4, 2, 2, 2, 1, 2, 4, 4, 1, 3, 4, 3, 4, 1, 3,
                          3, 4, 4, 3, 2, 3, 3, 4, 3, 1, 1, 2, 2, 4, 1, 2, 2, 3, 4, 1, 1, 3,
                          3, 4, 3, 3, 1, 2, 1, 4, 1, 3, 3, 2, 4, 3, 4, 1, 1, 1, 2, 4, 2, 2,
                          1, 2, 4, 2, 4, 2, 1, 1, 2, 1, 1, 4],
                         [3, 3, 2, 2, 1, 1, 4, 1, 1, 4, 1, 4, 4, 2, 2, 3, 1, 4, 4, 1, 2, 1,
                          4, 4, 1, 4, 2, 4, 2, 2, 3, 2, 2, 3, 1, 1, 4, 3, 4, 1, 1, 4, 2, 4,
                          3, 4, 3, 3, 1, 4, 3, 2, 4, 2, 1, 3, 3, 2, 2, 2, 2, 2, 3, 2, 4, 3,
                          4, 4, 3, 4, 3, 2, 4, 4, 1, 3, 4, 4, 3, 1, 2, 2, 2, 2, 4, 1, 4, 3,
                          2, 4, 4, 1, 4, 4, 3, 3, 4, 4, 3, 1],
                         [3, 2, 2, 1, 2, 2, 2, 1, 4, 2, 1, 4, 3, 3, 1, 4, 1, 2, 4, 4, 4, 4,
                          2, 1, 3, 3, 1, 3, 4, 1, 3, 4, 2, 4, 4, 4, 4, 4, 1, 4, 2, 4, 3, 3,
                          2, 3, 2, 3, 1, 4, 4, 3, 3, 2, 3, 3, 3, 1, 3, 1, 4, 3, 2, 4, 1, 4,
                          1, 2, 4, 2, 2, 3, 1, 4, 4, 4, 2, 3, 3, 4, 4, 2, 3, 4, 3, 1, 1, 2,
                          4, 1, 3, 4, 4, 1, 3, 3, 3, 1, 4, 3],
                         [3, 1, 2, 4, 4, 1, 1, 3, 3, 2, 4, 1, 1, 3, 3, 3, 1, 2, 1, 4, 4, 3,
                          2, 3, 4, 2, 3, 1, 2, 2, 3, 1, 2, 4, 3, 3, 2, 3, 3, 2, 2, 2, 3, 2,
                          1, 1, 4, 3, 1, 4, 3, 2, 4, 3, 1, 4, 2, 2, 4, 3, 4, 4, 3, 4, 4, 4,
                          1, 4, 1, 3, 1, 3, 4, 1, 3, 2, 4, 2, 3, 4, 2, 2, 2, 1, 1, 3, 4, 2,
                          2, 2, 1, 4, 2, 1, 1, 1, 4, 4, 1, 3],
                         [3, 2, 2, 4, 4, 1, 2, 2, 4, 2, 1, 4, 1, 2, 2, 3, 3, 4, 4, 3, 3, 2,
                          1, 4, 1, 4, 4, 1, 3, 4, 4, 3, 2, 3, 3, 2, 4, 1, 2, 3, 1, 3, 4, 4,
                          3, 4, 2, 4, 2, 1, 1, 4, 3, 4, 4, 2, 4, 4, 4, 1, 4, 1, 3, 1, 1, 4,
                          3, 4, 1, 2, 3, 2, 3, 1, 2, 2, 1, 4, 1, 1, 2, 3, 4, 2, 1, 4, 2, 4,
                          2, 1, 4, 3, 1, 2, 3, 1, 3, 4, 3, 2],
                         [3, 2, 4, 2, 4, 1, 2, 1, 1, 1, 4, 1, 4, 3, 2, 1, 1, 3, 2, 2, 1, 1,
                          1, 3, 4, 2, 3, 4, 4, 3, 3, 4, 1, 2, 2, 3, 4, 2, 3, 2, 1, 1, 3, 4,
                          4, 4, 1, 4, 3, 4, 1, 2, 4, 2, 1, 2, 4, 2, 2, 2, 2, 2, 3, 4, 1, 1,
                          2, 2, 3, 2, 3, 1, 1, 2, 2, 2, 1, 3, 3, 2, 3, 2, 4, 3, 2, 4, 4, 4,
                          3, 2, 3, 2, 4, 3, 4, 1, 4, 4, 2, 4],
                         [4, 3, 1, 1, 3, 4, 1, 3, 1, 4, 1, 4, 2, 4, 1, 1, 1, 3, 3, 2, 2, 2,
                          1, 1, 4, 1, 1, 4, 2, 2, 1, 4, 2, 3, 4, 2, 4, 2, 2, 1, 2, 3, 2, 4,
                          4, 4, 1, 1, 4, 3, 1, 1, 2, 3, 3, 3, 4, 1, 3, 1, 3, 2, 2, 2, 1, 3,
                          1, 3, 3, 1, 4, 1, 2, 1, 3, 2, 1, 4, 2, 3, 3, 3, 3, 2, 2, 2, 4, 1,
                          4, 3, 1, 3, 3, 1, 2, 1, 3, 2, 1, 2],
                         [1, 4, 1, 3, 3, 4, 1, 4, 1, 4, 2, 4, 4, 4, 4, 3, 3, 4, 4, 2, 3, 2,
                          1, 4, 2, 3, 1, 4, 4, 1, 1, 4, 4, 4, 2, 1, 3, 3, 4, 4, 3, 3, 4, 1,
                          1, 1, 2, 2, 1, 2, 1, 2, 4, 3, 3, 1, 1, 3, 3, 4, 4, 1, 4, 1, 2, 3,
                          1, 4, 2, 4, 2, 2, 3, 2, 4, 4, 3, 2, 2, 4, 2, 3, 1, 2, 4, 3, 1, 3,
                          1, 4, 2, 2, 3, 1, 1, 4, 3, 4, 1, 2],
                         [1, 1, 1, 2, 1, 3, 3, 2, 4, 4, 3, 1, 2, 1, 2, 3, 3, 3, 3, 2, 4, 4,
                          4, 4, 4, 4, 3, 2, 1, 1, 1, 1, 2, 1, 3, 3, 4, 4, 1, 3, 3, 2, 3, 1,
                          3, 2, 3, 1, 4, 4, 2, 4, 3, 4, 3, 1, 4, 1, 1, 1, 1, 3, 1, 1, 2, 1,
                          4, 1, 1, 2, 2, 3, 3, 2, 4, 1, 4, 2, 1, 1, 1, 3, 1, 2, 3, 4, 2, 2,
                          3, 1, 2, 1, 1, 1, 4, 3, 3, 3, 3, 1],
                         [4, 4, 1, 4, 3, 3, 1, 1, 3, 3, 4, 4, 4, 4, 2, 2, 1, 3, 3, 1, 3, 4,
                          4, 1, 4, 3, 3, 2, 4, 2, 3, 2, 4, 2, 1, 4, 4, 4, 4, 4, 1, 3, 4, 1,
                          2, 1, 4, 4, 4, 2, 4, 1, 4, 3, 3, 4, 4, 2, 2, 4, 4, 4, 4, 3, 3, 3,
                          1, 3, 1, 2, 1, 3, 3, 4, 4, 4, 2, 4, 1, 4, 1, 4, 3, 2, 3, 4, 4, 4,
                          1, 4, 3, 4, 2, 1, 2, 3, 1, 4, 4, 4],
                         [4, 4, 3, 3, 3, 3, 3, 2, 4, 2, 1, 1, 4, 4, 3, 1, 4, 2, 3, 2, 3, 4,
                          2, 1, 4, 1, 1, 3, 2, 2, 3, 4, 2, 1, 3, 4, 4, 4, 1, 2, 4, 1, 2, 1,
                          1, 3, 1, 4, 2, 2, 4, 3, 4, 1, 4, 3, 1, 4, 3, 4, 2, 2, 4, 4, 4, 4,
                          4, 4, 2, 2, 3, 2, 1, 3, 2, 1, 1, 1, 1, 4, 2, 3, 1, 1, 1, 2, 1, 4,
                          1, 4, 2, 4, 2, 4, 4, 1, 1, 4, 3, 3],
                         [2, 1, 2, 4, 2, 1, 1, 2, 2, 4, 2, 2, 4, 3, 1, 2, 3, 1, 3, 1, 2, 1,
                          1, 4, 4, 1, 1, 1, 3, 2, 4, 4, 2, 1, 4, 4, 1, 2, 4, 1, 3, 3, 1, 1,
                          2, 1, 4, 4, 2, 2, 1, 3, 1, 4, 2, 4, 1, 4, 3, 2, 3, 1, 4, 1, 3, 2,
                          1, 4, 1, 3, 3, 1, 1, 3, 4, 2, 3, 1, 4, 4, 2, 1, 1, 3, 3, 3, 4, 1,
                          1, 3, 3, 3, 4, 1, 2, 4, 4, 3, 1, 2],
                         [3, 4, 4, 4, 2, 4, 3, 2, 2, 4, 3, 4, 4, 2, 3, 4, 2, 3, 3, 4, 4, 2,
                          2, 1, 1, 1, 3, 1, 1, 3, 3, 4, 4, 4, 1, 4, 2, 1, 3, 3, 3, 1, 3, 1,
                          3, 4, 2, 1, 2, 3, 1, 2, 2, 1, 3, 2, 3, 3, 1, 1, 4, 4, 4, 3, 4, 3,
                          1, 1, 2, 2, 4, 3, 2, 1, 2, 2, 2, 3, 2, 1, 4, 2, 1, 1, 3, 3, 3, 1,
                          2, 1, 3, 4, 2, 2, 2, 4, 1, 2, 2, 4],
                         [4, 4, 2, 2, 4, 1, 3, 1, 2, 1, 1, 3, 3, 3, 3, 2, 2, 1, 4, 3, 3, 3,
                          4, 1, 3, 2, 4, 1, 2, 4, 2, 2, 2, 3, 3, 3, 3, 2, 4, 2, 1, 1, 3, 1,
                          2, 4, 1, 2, 4, 1, 4, 4, 2, 2, 4, 1, 4, 2, 3, 2, 4, 3, 3, 3, 3, 2,
                          2, 1, 2, 4, 3, 3, 2, 1, 2, 1, 3, 4, 1, 3, 3, 1, 3, 2, 3, 2, 3, 1,
                          2, 2, 3, 1, 1, 2, 1, 1, 3, 3, 4, 1],
                         [4, 1, 2, 1, 1, 4, 4, 3, 4, 2, 3, 4, 3, 2, 4, 1, 1, 1, 3, 1, 1, 2,
                          2, 3, 2, 1, 3, 1, 4, 3, 1, 3, 1, 2, 1, 3, 4, 1, 1, 3, 2, 3, 1, 3,
                          1, 2, 2, 1, 3, 3, 3, 3, 4, 4, 4, 4, 3, 1, 4, 2, 4, 2, 4, 2, 3, 4,
                          1, 3, 3, 3, 2, 1, 1, 3, 3, 4, 1, 4, 4, 1, 4, 2, 1, 1, 2, 2, 3, 3,
                          2, 1, 1, 1, 3, 3, 3, 3, 2, 1, 2, 2],
                         [4, 3, 2, 4, 2, 4, 1, 1, 1, 3, 1, 3, 1, 3, 2, 4, 2, 2, 4, 3, 4, 1,
                          2, 1, 4, 2, 3, 4, 4, 2, 3, 3, 2, 2, 3, 3, 2, 2, 4, 3, 3, 1, 3, 2,
                          4, 3, 1, 1, 1, 1, 3, 4, 1, 3, 3, 4, 4, 2, 2, 2, 3, 3, 1, 4, 1, 1,
                          4, 2, 3, 4, 3, 3, 2, 2, 4, 4, 1, 4, 4, 2, 2, 1, 3, 3, 1, 4, 3, 1,
                          4, 3, 1, 2, 2, 3, 1, 1, 3, 3, 1, 4],
                         [3, 3, 4, 2, 2, 4, 2, 1, 1, 1, 3, 4, 2, 4, 3, 1, 4, 4, 4, 2, 1, 1,
                          2, 4, 1, 1, 4, 4, 4, 1, 2, 3, 1, 2, 2, 4, 2, 4, 2, 2, 4, 2, 3, 3,
                          3, 4, 3, 1, 1, 4, 1, 2, 4, 3, 2, 4, 3, 1, 2, 1, 2, 1, 4, 3, 2, 3,
                          3, 3, 2, 4, 3, 4, 3, 3, 4, 3, 4, 4, 4, 3, 1, 1, 2, 1, 1, 3, 2, 3,
                          2, 3, 1, 4, 3, 1, 3, 4, 2, 4, 2, 2],
                         [4, 1, 1, 4, 4, 1, 3, 1, 1, 1, 1, 2, 3, 1, 4, 4, 2, 1, 1, 4, 3, 4,
                          1, 3, 3, 2, 3, 2, 1, 4, 3, 1, 2, 2, 2, 4, 3, 1, 4, 4, 2, 3, 1, 2,
                          3, 2, 1, 1, 2, 1, 3, 3, 1, 4, 2, 4, 1, 4, 1, 4, 2, 4, 2, 2, 4, 4,
                          4, 1, 4, 4, 3, 1, 4, 3, 4, 2, 1, 1, 3, 2, 1, 4, 1, 3, 2, 4, 3, 1,
                          3, 2, 4, 2, 4, 1, 4, 2, 4, 2, 3, 3],
                         [4, 2, 2, 1, 3, 3, 2, 4, 3, 1, 4, 2, 2, 2, 1, 4, 4, 4, 2, 4, 1, 1,
                          1, 3, 3, 4, 3, 2, 2, 4, 1, 3, 1, 3, 2, 4, 3, 3, 1, 2, 3, 2, 4, 3,
                          1, 4, 3, 2, 4, 4, 1, 1, 2, 4, 4, 3, 3, 1, 2, 1, 3, 4, 1, 1, 2, 3,
                          3, 3, 2, 3, 4, 4, 3, 3, 3, 2, 2, 4, 2, 1, 3, 3, 1, 2, 4, 1, 2, 4,
                          2, 1, 3, 2, 3, 3, 4, 4, 4, 3, 2, 3],
                         [4, 4, 3, 2, 3, 3, 4, 3, 1, 1, 2, 4, 3, 4, 1, 2, 2, 1, 1, 3, 2, 3,
                          1, 3, 1, 4, 3, 2, 1, 1, 3, 4, 4, 3, 3, 1, 3, 4, 1, 3, 4, 1, 4, 2,
                          3, 1, 4, 1, 1, 3, 3, 2, 4, 1, 2, 1, 3, 2, 1, 1, 4, 2, 2, 2, 1, 3,
                          4, 3, 1, 2, 1, 4, 1, 3, 2, 4, 4, 1, 1, 2, 3, 1, 1, 4, 3, 3, 3, 2,
                          3, 2, 3, 1, 1, 3, 1, 1, 4, 3, 2, 2],
                         [1, 1, 2, 3, 2, 1, 2, 1, 4, 4, 3, 2, 3, 2, 2, 1, 1, 2, 2, 1, 2, 2,
                          4, 4, 2, 4, 2, 4, 1, 4, 3, 1, 1, 4, 1, 3, 2, 3, 2, 3, 2, 2, 1, 4,
                          1, 2, 3, 1, 3, 2, 1, 2, 4, 2, 1, 1, 2, 3, 4, 3, 2, 4, 3, 3, 1, 1,
                          2, 4, 4, 4, 1, 2, 3, 2, 4, 1, 3, 3, 4, 2, 4, 4, 1, 3, 3, 3, 4, 3,
                          1, 2, 2, 1, 4, 2, 3, 1, 4, 4, 4, 3],
                         [2, 2, 3, 1, 1, 1, 4, 2, 2, 1, 3, 2, 4, 3, 1, 1, 3, 4, 1, 2, 1, 1,
                          3, 4, 3, 4, 4, 4, 4, 3, 1, 2, 2, 3, 2, 4, 1, 1, 4, 3, 4, 4, 2, 2,
                          1, 2, 1, 4, 3, 2, 4, 2, 4, 4, 1, 2, 4, 2, 2, 3, 1, 4, 3, 3, 3, 1,
                          4, 2, 2, 2, 4, 4, 2, 2, 3, 3, 1, 3, 3, 1, 3, 3, 4, 4, 3, 4, 4, 4,
                          1, 4, 3, 2, 1, 4, 3, 2, 2, 1, 2, 1],
                         [2, 4, 1, 2, 3, 3, 3, 2, 3, 4, 1, 4, 4, 4, 4, 1, 1, 2, 3, 2, 1, 3,
                          4, 1, 3, 2, 1, 3, 2, 3, 2, 4, 3, 4, 2, 1, 1, 2, 4, 4, 1, 2, 4, 4,
                          3, 1, 4, 2, 1, 4, 2, 2, 2, 3, 4, 3, 3, 4, 2, 3, 1, 4, 3, 4, 1, 2,
                          2, 2, 3, 4, 3, 3, 4, 1, 4, 4, 3, 1, 2, 3, 2, 3, 1, 4, 3, 3, 3, 3,
                          3, 2, 4, 4, 1, 1, 1, 3, 1, 2, 4, 1],
                         [3, 2, 2, 1, 3, 4, 1, 1, 1, 2, 1, 4, 1, 4, 1, 1, 3, 3, 1, 4, 2, 3,
                          3, 2, 2, 3, 4, 4, 2, 2, 2, 2, 3, 1, 4, 2, 3, 4, 4, 2, 2, 1, 1, 4,
                          3, 4, 4, 2, 3, 1, 1, 3, 2, 1, 3, 1, 1, 3, 2, 1, 1, 2, 4, 4, 4, 3,
                          1, 3, 1, 2, 2, 1, 4, 3, 3, 4, 4, 4, 1, 3, 1, 1, 4, 2, 2, 1, 2, 3,
                          4, 1, 2, 3, 4, 4, 4, 1, 2, 4, 1, 3]])

he = HaloExchange(structured=True,tensor_used=True,double_precision=True,corner_exchanged=False)
sub_nx,sub_ny,current_mesh =  he.initialization(problem_mesh,False,False)

# print(f'{sub_nx},{sub_ny}')
# print(f'{current_mesh.shape[0]},{current_mesh.shape[1]}')

print("[NEIGHBORS OF PROC {}] :".format(he.rank),he.neighbors)

current_mesh = he.structured_halo_update_2D(current_mesh) # update once

# descretized Laplacian operator by tf
w = ([[[[0.0],
        [0.15],
        [0.0]],

       [[0.25],
        [-0.8],
        [0.15]],

       [[0.0],
        [0.25],
        [0.0]]]])

init_bias = np.zeros((1,))
init_kernel = w
kernel_initializer_2 = tf.keras.initializers.constant(init_kernel)
bias_initializer = tf.keras.initializers.constant(init_bias)

CNN2D = keras.models.Sequential([
    keras.layers.InputLayer(input_shape=(sub_nx+2, sub_ny+2, 1)),
    tf.keras.layers.Conv2D(1, kernel_size=3, strides=1, padding='VALID',
                           kernel_initializer=kernel_initializer_2,
                           bias_initializer=bias_initializer),
])

# CNN2D.compile(loss="mse",
#       optimizer=keras.optimizers.Nadam(learning_rate=0.0001, beta_1=0.9, beta_2=0.999))

current_mesh_new = np.empty_like(current_mesh)

print(current_mesh.shape)

rank = he.rank

start = perf_counter()
for t in range(100):
      current_mesh_new = CNN2D.predict(current_mesh)
      current_mesh = np.copy(current_mesh_new)
      # need re-padding and type-conversion
      current_mesh = HaloExchange.padding_block_halo_2D(current_mesh,1,0)
      current_mesh = tf.convert_to_tensor(current_mesh.reshape(1,sub_nx+2,sub_ny+2,1))
      current_mesh = he.structured_halo_update_2D(current_mesh)
      
end = perf_counter()
print(f'[TIME CONSUMED] {end - start} sec')

result = current_mesh.numpy().reshape(sub_nx+2,sub_ny+2)[1:-1,1:-1]

np.save('parallel_out/ans_{}_ai.npy'.format(rank),result)
